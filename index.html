<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Charles Git Barber Receipt — Access Protected</title>

<style>
  @import url('https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&family=Roboto+Mono&display=swap');

  * {
    box-sizing: border-box;
  }

  body {
    margin: 0; padding: 0;
    background: linear-gradient(135deg, #6b5b95, #9a8c98);
    font-family: 'Poppins', sans-serif;
    min-height: 100vh;
    display: flex;
    align-items: center;
    justify-content: center;
    color: #2e2e3e;
    transition: background 0.5s ease;
  }

  /* Access Screen */
  #accessScreen {
    background: #f3e6ff;
    border-radius: 20px;
    padding: 45px 35px 35px 35px;
    box-shadow: 0 14px 40px rgba(107, 91, 149, 0.6);
    max-width: 400px;
    width: 90vw;
    text-align: center;
    position: relative;
  }

  #accessScreen h1 {
    font-family: 'Poppins', sans-serif;
    font-weight: 600;
    font-size: 2.7rem;
    margin-bottom: 22px;
    color: #3f2c56;
    letter-spacing: 2px;
    user-select: none;
    animation: fadeInSlideDown 1s ease forwards;
  }

  @keyframes fadeInSlideDown {
    0% {opacity: 0; transform: translateY(-30px);}
    100% {opacity: 1; transform: translateY(0);}
  }

  .password-wrapper {
    position: relative;
    margin-top: 32px;
  }

  #password {
    width: 100%;
    padding: 16px 50px 16px 18px;
    font-size: 1.25rem;
    border-radius: 12px;
    border: 2px solid #a093c7;
    outline-color: #9b84b7;
    font-family: 'Roboto Mono', monospace;
    transition: border-color 0.3s;
    background: #f8f2ff;
    color: #3f2c56;
  }
  #password:focus {
    border-color: #6b5b95;
    background: #e9dcff;
  }

  .toggle-eye {
    position: absolute;
    right: 14px;
    top: 50%;
    transform: translateY(-50%);
    cursor: pointer;
    font-size: 1.5rem;
    user-select: none;
    color: #6b5b95;
    transition: color 0.3s;
  }
  .toggle-eye:hover {
    color: #9a8c98;
  }

  #accessBtn {
    margin-top: 34px;
    background: #5a478b;
    border: none;
    color: white;
    padding: 16px 0;
    width: 100%;
    border-radius: 14px;
    font-size: 1.3rem;
    cursor: pointer;
    font-family: 'Poppins', sans-serif;
    transition: background 0.3s, box-shadow 0.3s;
    box-shadow: 0 6px 14px rgba(90, 71, 139, 0.6);
  }
  #accessBtn:hover {
    background: #3f2c56;
    box-shadow: 0 8px 18px rgba(63, 44, 86, 0.8);
  }

  #errorMsg {
    color: #d94f4f;
    margin-top: 18px;
    font-weight: 700;
    height: 26px;
    font-family: 'Roboto Mono', monospace;
  }

  /* Receipt container */
  #receiptContainer {
    display: none;
    background: #fefefe;
    max-width: 780px;
    width: 95vw;
    border-radius: 20px;
    box-shadow: 0 14px 40px rgba(107, 91, 149, 0.35);
    padding: 35px 45px;
    font-family: 'Roboto Mono', monospace;
    color: #2e2e3e;
    transition: box-shadow 0.3s ease;
  }
  #receiptContainer:focus-within {
    box-shadow: 0 14px 40px rgba(74, 71, 163, 0.55);
    outline: none;
  }

  #receiptHeader {
    display: flex;
    flex-wrap: wrap;
    justify-content: space-between;
    align-items: center;
    border-bottom: 3px solid #bfa2db;
    padding-bottom: 15px;
    margin-bottom: 22px;
    gap: 10px;
  }

  #shopName {
    font-family: 'Poppins', sans-serif;
    font-weight: 700;
    color: #5a478b;
    font-size: 2.4rem;
    margin: 0;
    user-select: text;
    border-bottom: 2px dashed transparent;
    padding-bottom: 3px;
    cursor: text;
    transition: border-color 0.3s;
  }
  #shopName:focus {
    outline: none;
    border-bottom: 2px dashed #7e7cc2;
  }

  #shopContact {
    font-size: 1rem;
    color: #6e649f;
    user-select: text;
    border-bottom: 2px dashed transparent;
    padding-bottom: 3px;
    cursor: text;
    transition: border-color 0.3s;
    line-height: 1.3;
    margin: 0;
  }
  #shopContact:focus {
    outline: none;
    border-bottom: 2px dashed #7e7cc2;
  }

  /* Receipt Meta (Receipt #, Date, Cashier) */
  #receiptMeta {
    display: flex;
    flex-wrap: wrap;
    gap: 18px;
    margin-bottom: 26px;
    font-size: 1.1rem;
  }
  #receiptMeta label {
    font-weight: 600;
    color: #5a478b;
    user-select: none;
    min-width: 130px;
  }
  #receiptMeta input {
    padding: 8px 14px;
    border-radius: 12px;
    border: 2px solid #bfa2db;
    font-family: 'Roboto Mono', monospace;
    font-size: 1.1rem;
    width: 160px;
    transition: border-color 0.3s;
    color: #3f2c56;
  }
  #receiptMeta input:focus {
    border-color: #7e7cc2;
    outline: none;
    background: #eae5f6;
  }

  /* Client info */
  #clientInfo {
    display: flex;
    flex-wrap: nowrap;
    gap: 12px;
    margin-bottom: 26px;
  }
  #clientInfo input {
    padding: 12px 16px;
    font-size: 1.1rem;
    border-radius: 14px;
    border: 2px solid #bfa2db;
    transition: border-color 0.3s, background 0.3s;
    color: #3f2c56;
    background: #f9f7ff;
  }
  #clientInfo input:focus {
    border-color: #7e7cc2;
    background: #eae5f6;
    outline: none;
  }

  /* Table styling */
  table {
    width: 100%;
    border-collapse: collapse;
    margin-bottom: 26px;
    font-size: 1.1rem;
  }
  table th, table td {
    border-bottom: 2px solid #bfa2db;
    padding: 14px 10px;
    text-align: left;
    vertical-align: middle;
  }
  table th {
    background: #7e7cc2;
    color: white;
    font-weight: 600;
    user-select: none;
  }

  table td input[type="text"],
  table td input[type="number"] {
    width: 100%;
    padding: 8px 14px;
    border-radius: 12px;
    border: 2px solid #bfa2db;
    font-family: 'Roboto Mono', monospace;
    font-size: 1.1rem;
    box-sizing: border-box;
    transition: border-color 0.3s, background 0.3s;
    color: #3f2c56;
    background: #f9f7ff;
  }
  table td input[type="text"]:focus,
  table td input[type="number"]:focus {
    border-color: #7e7cc2;
    background: #eae5f6;
    outline: none;
  }

  .remove-row-btn {
    background: transparent;
    border: none;
    color: #c04e4e;
    font-size: 1.6rem;
    cursor: pointer;
    user-select: none;
    transition: color 0.3s;
  }
  .remove-row-btn:hover {
    color: #852e2e;
  }

  /* Add service button */
  #addServiceBtn {
    background: #5a478b;
    color: white;
    padding: 16px 24px;
    border: none;
    border-radius: 16px;
    font-family: 'Poppins', sans-serif;
    font-weight: 600;
    font-size: 1.3rem;
    cursor: pointer;
    transition: background 0.3s, box-shadow 0.3s;
    margin-bottom: 28px;
    box-shadow: 0 5px 15px rgba(90, 71, 139, 0.5);
  }
  #addServiceBtn:hover {
    background: #3f2c56;
    box-shadow: 0 6px 18px rgba(63, 44, 86, 0.7);
  }

  /* Total Section */
  #totalSection {
    text-align: right;
    font-size: 1.75rem;
    font-weight: 700;
    color: #5a478b;
    margin-bottom: 16px;
    user-select: none;
    text-shadow: 0 1px 1px rgba(233, 229, 246, 0.6);
  }

  /* Print and PDF Buttons */
  #actions {
    display: flex;
    justify-content: flex-end;
    gap: 18px;
  }

  #actions button {
    padding: 12px 28px;
    font-size: 1.15rem;
    border: none;
    cursor: pointer;
    font-family: 'Poppins', sans-serif;
    font-weight: 600;
    border-radius: 16px;
    background: #5a478b;
    color: white;
    box-shadow: 0 5px 15px rgba(90, 71, 139, 0.6);
    transition: background 0.3s, box-shadow 0.3s;
  }
  #actions button:hover {
    background: #3f2c56;
    box-shadow: 0 7px 20px rgba(63, 44, 86, 0.8);
  }

  /* Responsive improvements for small screens */
  @media (max-width: 560px) {
    #receiptContainer {
      padding: 28px 22px;
    }

    #receiptHeader {
      flex-direction: column;
      align-items: flex-start;
      gap: 4px;
      padding-bottom: 12px;
      margin-bottom: 18px;
    }

    #shopName {
      font-size: 2.1rem;
    }
    #shopContact {
      font-size: 0.95rem;
      margin-bottom: 2px;
    }

    #receiptMeta {
      flex-direction: column;
      gap: 12px;
    }
    #receiptMeta label {
      min-width: auto;
    }
    #receiptMeta input {
      width: 100%;
      max-width: 100%;
    }

    /* Fix client info: wrap and reduce input size */
    #clientInfo {
      flex-wrap: wrap;
      gap: 8px;
      margin-bottom: 20px;
    }
    #clientInfo input {
      flex: 1 1 45%;
      font-size: 1rem;
      padding: 10px 14px;
      border-radius: 12px;
      min-width: 0;
      box-sizing: border-box;
    }

    /* Services table - stack with titles */
    table, thead, tbody, th, td, tr {
      display: block;
      width: 100%;
    }
    thead tr {
      position: absolute;
      top: -9999px;
      left: -9999px;
    }
    tr {
      margin-bottom: 20px;
      border-bottom: 1px solid #bfa2db;
      padding-bottom: 14px;
      display: grid;
      grid-template-columns: 1fr;
      gap: 10px;
    }
    td {
      border: none;
      padding: 0 !important;
      margin: 0;
      font-size: 1.1rem;
      font-weight: 600;
      color: #4b4175;
    }
    td:last-child {
      text-align: right;
    }

    /* Add labels above inputs */
    td.service-name::before {
      content: "Service";
      display: block;
      font-weight: 700;
      margin-bottom: 4px;
      color: #5a478b;
    }
    td.service-qty::before {
      content: "Quantity";
      display: block;
      font-weight: 700;
      margin-bottom: 4px;
      color: #5a478b;
    }
    td.service-price::before {
      content: "Price ($)";
      display: block;
      font-weight: 700;
      margin-bottom: 4px;
      color: #5a478b;
    }
    td.remove-btn::before {
      content: "Remove";
      display: block;
      font-weight: 700;
      margin-bottom: 4px;
      color: #c04e4e;
      text-align: right;
    }

    td input[type="text"],
    td input[type="number"] {
      width: 100%;
      padding: 10px 14px;
      font-weight: 400;
      color: #3f2c56;
      font-family: 'Roboto Mono', monospace;
      font-size: 1rem;
      background: #f5f1ff;
      border-radius: 12px;
      border: 2px solid #bfa2db;
      transition: border-color 0.3s, background 0.3s;
    }
    td input[type="text"]:focus,
    td input[type="number"]:focus {
      border-color: #7e7cc2;
      background: #e2dbff;
      outline: none;
      font-weight: 600;
    }

    /* Remove button styling */
    .remove-row-btn {
      font-size: 1.8rem;
      color: #c04e4e;
      background: #fdeeee;
      border-radius: 8px;
      cursor: pointer;
      transition: background-color 0.3s, color 0.3s;
      padding: 4px 10px;
      user-select: none;
    }
    .remove-row-btn:hover {
      background: #fcd5d5;
      color: #7a2727;
    }

    #addServiceBtn {
      font-size: 1.4rem;
      padding: 18px 26px;
      width: 100%;
      box-shadow: 0 6px 18px rgba(90, 71, 139, 0.55);
      border-radius: 16px;
    }

    #totalSection {
      font-size: 2.1rem;
      margin-top: 18px;
      text-align: right;
      font-weight: 700;
      color: #5a478b;
      text-shadow: 0 1px 2px rgba(156, 138, 156, 0.6);
      user-select: none;
    }

    #actions {
      flex-direction: column;
      gap: 14px;
      justify-content: center;
    }
    #actions button {
      width: 100%;
      border-radius: 16px;
    }
  }

  /* Placeholder vanish on focus */
  input:focus::placeholder {
    color: transparent;
  }

  /* PRINT STYLES */
  @media print {
    body {
      background: white !important;
      color: #000 !important;
      font-family: 'Roboto Mono', monospace !important;
    }
    #accessScreen, #addServiceBtn, #actions {
      display: none !important;
    }
    #receiptContainer {
      box-shadow: none !important;
      width: 100% !important;
      max-width: 100% !important;
      padding: 0 !important;
      margin: 0 !important;
    }
    input, button {
      border: none !important;
      box-shadow: none !important;
      background: transparent !important;
      color: #000 !important;
      font-weight: normal !important;
      font-size: 12pt !important;
      pointer-events: none !important;
      -webkit-print-color-adjust: exact;
    }
    input:focus {
      outline: none !important;
    }
    /* Show inputs as plain text */
    input::placeholder {
      color: transparent !important;
    }
    td input {
      border: none !important;
      background: transparent !important;
      font-weight: normal !important;
      font-size: 12pt !important;
      color: #000 !important;
      pointer-events: none !important;
      width: auto !important;
    }
    .remove-row-btn {
      display: none !important;
    }
  }

</style>
</head>

<body>
<!-- Access Screen -->
<div id="accessScreen" role="dialog" aria-modal="true" aria-labelledby="accessTitle">
  <h1 id="accessTitle" tabindex="0">Charles Git </h1>
  <div class="password-wrapper">
    <input
      type="password"
      id="password"
      name="password"
      autocomplete="current-password"
      placeholder="Enter Password"
      aria-label="Password"
    />
    <span id="togglePassword" class="toggle-eye" aria-label="Toggle Password Visibility" role="button" tabindex="0">&#128065;</span>
  </div>
  <button id="accessBtn" type="button" aria-describedby="errorMsg">Access</button>
  <p id="errorMsg" aria-live="assertive" role="alert"></p>
</div>

<!-- Receipt Container -->
<section id="receiptContainer" tabindex="0" aria-label="Barber Receipt">
  <header id="receiptHeader">
    <h2 id="shopName" contenteditable="true" aria-label="Shop Name" role="textbox" spellcheck="false" tabindex="0">Charles Git Barber Shop</h2>
    <p id="shopContact" contenteditable="true" aria-label="Shop Contact Info" role="textbox" spellcheck="false" tabindex="0">
      | Phone: (314)3657077 | Email: royalpettyerrandsrv@gmail.com
    </p>
  </header>

  <div id="receiptMeta" role="form" aria-label="Receipt metadata">
    <label for="receiptNumber">Receipt #</label>
    <input type="text" id="receiptNumber" name="receiptNumber" aria-required="true" placeholder="e.g. 00432" />

    <label for="receiptDate">Date</label>
    <input type="date" id="receiptDate" name="receiptDate" aria-required="true" />

    <label for="cashierName">Cashier</label>
    <input type="text" id="cashierName" name="cashierName" aria-required="true" placeholder="Cashier name" />
  </div>

  <div id="clientInfo" role="form" aria-label="Client information">
    <input type="text" id="clientName" name="clientName" placeholder="Client Name" aria-required="true" />
    <input type="email" id="clientEmail" name="clientEmail" placeholder="Client Email" aria-required="true" />
    <input type="tel" id="clientPhone" name="clientPhone" placeholder="Client Phone" aria-required="true" pattern="[0-9]{9,15}" />
  </div>

  <table aria-label="Services provided">
    <thead>
      <tr>
        <th scope="col">Service</th>
        <th scope="col">Quantity</th>
        <th scope="col">Price ($)</th>
        <th scope="col" aria-label="Remove service row"></th>
      </tr>
    </thead>
    <tbody id="servicesTableBody">
      <tr>
        <td class="service-name"><input type="text" class="service-input" placeholder="Service name" aria-label="Service name" /></td>
        <td class="service-qty"><input type="number" class="qty-input" min="1" value="1" aria-label="Service quantity" /></td>
        <td class="service-price"><input type="number" class="price-input" min="0" step="0.01" value="0.00" aria-label="Service price" /></td>
        <td class="remove-btn"><button type="button" class="remove-row-btn" aria-label="Remove this service row">&times;</button></td>
      </tr>
    </tbody>
  </table>

  <button id="addServiceBtn" type="button" aria-label="Add new service row">Add Service</button>

  <div id="totalSection" aria-live="polite" aria-atomic="true">Total: $0.00</div>

  <div id="actions">
    <button id="printBtn" type="button" aria-label="Print receipt">Print Receipt</button>
    <!--button id="downloadPdfBtn" type="button" aria-label="Download receipt as PDF">Download PDF</button-->
  </div>
</section>

<script>
  const accessScreen = document.getElementById('accessScreen');
  const receiptContainer = document.getElementById('receiptContainer');
  const passwordInput = document.getElementById('password');
  const accessBtn = document.getElementById('accessBtn');
  const errorMsg = document.getElementById('errorMsg');
  const togglePassword = document.getElementById('togglePassword');

  // Toggle password visibility
  togglePassword.addEventListener('click', () => {
    if (passwordInput.type === 'password') {
      passwordInput.type = 'text';
      togglePassword.textContent = '🙈';
      togglePassword.setAttribute('aria-label', 'Hide Password');
    } else {
      passwordInput.type = 'password';
      togglePassword.textContent = '👁️';
      togglePassword.setAttribute('aria-label', 'Show Password');
    }
    passwordInput.focus();
  });
  togglePassword.addEventListener('keypress', (e) => {
    if (e.key === 'Enter' || e.key === ' ') {
      e.preventDefault();
      togglePassword.click();
    }
  });

  // Password check
  accessBtn.addEventListener('click', () => {
    const entered = passwordInput.value.trim();
    const correctPassword = 'kutchee';
    if (entered === correctPassword) {
      accessScreen.style.display = 'none';
      receiptContainer.style.display = 'block';
      receiptContainer.focus();
      errorMsg.textContent = '';
    } else {
      errorMsg.textContent = 'Incorrect password. Please try again.';
      passwordInput.value = '';
      passwordInput.focus();
    }
  });

  passwordInput.addEventListener('keydown', (e) => {
    if (e.key === 'Enter') {
      accessBtn.click();
    }
  });

  // Services table functionality
  const addServiceBtn = document.getElementById('addServiceBtn');
  const servicesTableBody = document.getElementById('servicesTableBody');
  const totalSection = document.getElementById('totalSection');

  function updateTotal() {
    let total = 0;
    const rows = servicesTableBody.querySelectorAll('tr');
    rows.forEach(row => {
      const qtyInput = row.querySelector('.qty-input');
      const priceInput = row.querySelector('.price-input');

      const qty = parseInt(qtyInput.value) || 0;
      const price = parseFloat(priceInput.value) || 0;

      total += qty * price;
    });

    totalSection.textContent = 'Total: $' + total.toFixed(2);
  }

  // Event delegation for inputs and remove buttons in services table
  servicesTableBody.addEventListener('input', (e) => {
    if (
      e.target.classList.contains('qty-input') ||
      e.target.classList.contains('price-input')
    ) {
      updateTotal();
    }
  });

  servicesTableBody.addEventListener('click', (e) => {
    if (e.target.classList.contains('remove-row-btn')) {
      const row = e.target.closest('tr');
      if (servicesTableBody.querySelectorAll('tr').length > 1) {
        row.remove();
        updateTotal();
      } else {
        alert('You must have at least one service.');
      }
    }
  });

  addServiceBtn.addEventListener('click', () => {
    const newRow = document.createElement('tr');

    newRow.innerHTML = `
      <td class="service-name"><input type="text" class="service-input" placeholder="Service name" aria-label="Service name" /></td>
      <td class="service-qty"><input type="number" class="qty-input" min="1" value="1" aria-label="Service quantity" /></td>
      <td class="service-price"><input type="number" class="price-input" min="0" step="0.01" value="0.00" aria-label="Service price" /></td>
      <td class="remove-btn"><button type="button" class="remove-row-btn" aria-label="Remove this service row">&times;</button></td>
    `;

    servicesTableBody.appendChild(newRow);
    updateTotal();
  });

  // Initialize total on page show
  updateTotal();

  // Print function
  document.getElementById('printBtn').addEventListener('click', () => {
    window.print();
  });

  // PDF download
  document.getElementById('downloadPdfBtn').addEventListener('click', async () => {
    // Dynamically import jspdf
    const { jsPDF } = await import('https://cdn.jsdelivr.net/npm/jspdf@2.5.1/dist/jspdf.umd.min.js');
    const doc = new jsPDF();

    // Build the receipt text from inputs
    const shopName = document.getElementById('shopName').textContent.trim();
    const shopContact = document.getElementById('shopContact').textContent.trim();

    const receiptNumber = document.getElementById('receiptNumber').value.trim() || 'N/A';
    const receiptDate = document.getElementById('receiptDate').value || 'N/A';
    const cashierName = document.getElementById('cashierName').value.trim() || 'N/A';

    const clientName = document.getElementById('clientName').value.trim() || 'N/A';
    const clientEmail = document.getElementById('clientEmail').value.trim() || 'N/A';
    const clientPhone = document.getElementById('clientPhone').value.trim() || 'N/A';

    let y = 15;
    const lineHeight = 8;
    const pageWidth = doc.internal.pageSize.getWidth();

    doc.setFont('Roboto Mono');
    doc.setFontSize(22);
    doc.text(shopName, pageWidth / 2, y, { align: 'center' });
    y += lineHeight;
    doc.setFontSize(11);
    doc.text(shopContact, pageWidth / 2, y, { align: 'center' });
    y += lineHeight * 2;

    doc.setFontSize(14);
    doc.text(`Receipt #: ${receiptNumber}`, 14, y);
    y += lineHeight;
    doc.text(`Date: ${receiptDate}`, 14, y);
    y += lineHeight;
    doc.text(`Cashier: ${cashierName}`, 14, y);
    y += lineHeight * 2;

    doc.setFontSize(16);
    doc.text('Client Information:', 14, y);
    y += lineHeight;
    doc.setFontSize(12);
    doc.text(`Name: ${clientName}`, 14, y);
    y += lineHeight;
    doc.text(`Email: ${clientEmail}`, 14, y);
    y += lineHeight;
    doc.text(`Phone: ${clientPhone}`, 14, y);
    y += lineHeight * 2;

    doc.setFontSize(16);
    doc.text('Services Provided:', 14, y);
    y += lineHeight;

    // Table Headers
    doc.setFontSize(12);
    doc.text('Service', 14, y);
    doc.text('Qty', 100, y);
    doc.text('Price', 130, y, { align: 'right' });
    doc.text('Total', 180, y, { align: 'right' });
    y += lineHeight;

    doc.setDrawColor(0);
    doc.line(14, y - 4, 196, y - 4);

    // Services
    const rows = servicesTableBody.querySelectorAll('tr');
    let grandTotal = 0;
    rows.forEach(row => {
      const service = row.querySelector('.service-input').value.trim() || 'N/A';
      const qty = parseInt(row.querySelector('.qty-input').value) || 0;
      const price = parseFloat(row.querySelector('.price-input').value) || 0;
      const total = qty * price;
      grandTotal += total;

      doc.text(service, 14, y);
      doc.text(qty.toString(), 100, y);
      doc.text(`$${price.toFixed(2)}`, 130, y, { align: 'right' });
      doc.text(`$${total.toFixed(2)}`, 180, y, { align: 'right' });
      y += lineHeight;
    });

    y += lineHeight;
    doc.setFontSize(14);
    doc.setTextColor(90, 71, 139);
    doc.text(`Grand Total: $${grandTotal.toFixed(2)}`, 180, y, { align: 'right' });

    doc.save(`Receipt_${receiptNumber || 'unknown'}.pdf`);
  });
</script>

</body>
</html>
